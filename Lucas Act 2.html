<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<meta name="theme-color" content="#000000" />
<title>MU/TH/UR 6500 — DIRECTIVE</title>

<style>
  :root{
    --bg:#000;
    --fg:#7af042;
    --fg2:#54b92f;
    --line:rgba(122,240,66,.28);
    --line2:rgba(122,240,66,.16);
    --pad: clamp(10px, 2.8vw, 16px);
    --radius: 12px;

    --fontBase: clamp(15px, 3.2vw, 22px);
    --fontSmall: clamp(12px, 2.6vw, 16px);
    --fontTiny: clamp(11px, 2.2vw, 14px);
  }

  html, body{
    height:100%;
    margin:0;
    background:var(--bg);
    color:var(--fg);
    font-family:"Share Tech Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    font-size: var(--fontBase);
    overflow:hidden;
    -webkit-font-smoothing: antialiased;
    text-rendering: geometricPrecision;
    touch-action: manipulation;
  }

  body:before{
    content:"";
    position:fixed; inset:0;
    pointer-events:none;
    background:
      radial-gradient(circle at 50% 30%, rgba(122,240,66,.10), transparent 55%),
      linear-gradient(to bottom, rgba(0,0,0,.10), rgba(0,0,0,.55)),
      repeating-linear-gradient(to bottom,
        rgba(255,255,255,.03) 0px, rgba(255,255,255,.03) 1px,
        rgba(0,0,0,0) 2px, rgba(0,0,0,0) 4px
      );
    mix-blend-mode: screen;
    opacity:.9;
  }

  #app{
    height:100%;
    display:grid;
    grid-template-rows:auto 1fr;
    min-width:0;
  }

  #topbar{
    padding: calc(var(--pad) + env(safe-area-inset-top)) var(--pad) var(--pad);
    border-bottom:1px solid var(--line);
    background: linear-gradient(to bottom, rgba(15,25,15,.7), rgba(0,0,0,0));
    display:grid;
    gap: 6px;
    min-width:0;
  }
  #title{
    letter-spacing:.14em;
    text-transform:uppercase;
    font-weight:700;
    font-size: 1.0em;
    line-height:1.15;
    min-width:0;
  }
  #statusrow{
    display:flex;
    gap:10px;
    align-items:baseline;
    justify-content:space-between;
    min-width:0;
  }
  #statusline{
    color:var(--fg2);
    opacity:.95;
    letter-spacing:.07em;
    font-size: var(--fontSmall);
    line-height:1.2;
    flex:1;
    min-width:0;
    overflow:hidden;
    white-space:nowrap;
    text-overflow:ellipsis;
  }
  #clock{
    color:var(--fg2);
    opacity:.85;
    letter-spacing:.08em;
    font-size: var(--fontSmall);
    white-space:nowrap;
    flex:none;
  }

  #workspace{
    margin: var(--pad);
    border:1px solid var(--line);
    border-radius: var(--radius);
    background: linear-gradient(180deg, rgba(10,20,10,.55), rgba(0,0,0,.35));
    display:grid;
    grid-template-rows:auto 1fr auto;
    overflow:hidden;
    min-height:0;
    min-width:0;
    position:relative;
  }

  #wsHeader{
    padding: 12px;
    border-bottom:1px solid var(--line2);
    display:grid;
    gap:6px;
    background: rgba(0,0,0,.18);
    min-width:0;
  }
  #wsTitle{
    text-transform:uppercase;
    letter-spacing:.12em;
    font-weight:700;
    font-size: var(--fontSmall);
    line-height:1.2;
    min-width:0;
  }
  #wsMeta{
    color:var(--fg2);
    opacity:.88;
    font-size: var(--fontTiny);
    letter-spacing:.06em;
    text-transform:uppercase;
    line-height:1.2;
    overflow:hidden;
    white-space:nowrap;
    text-overflow:ellipsis;
    min-width:0;
  }

  #linewrap{
    position:relative;
    overflow:auto;
    -webkit-overflow-scrolling: touch;
    padding: 12px;
    padding-right: 10px;
    box-sizing:border-box;
    user-select:none;
    -webkit-user-select:none;
    -webkit-touch-callout:none;
    min-height:0;
    min-width:0;
  }

  #linewrap::-webkit-scrollbar{ width: 10px; }
  #linewrap::-webkit-scrollbar-thumb{ background: rgba(122,240,66,.25); border-radius: 10px; }
  #linewrap::-webkit-scrollbar-track{ background: transparent; }

  #measure{ max-width: 56ch; }

  .line{
    margin:0 0 10px 0;
    position:relative;
    opacity:.98;
    text-shadow: 0 0 10px rgba(122,240,66,0.10);
  }

  .sweep{
    position:absolute;
    inset:0;
    pointer-events:none;
    background:linear-gradient(
      90deg,
      transparent 0%,
      rgba(122,240,66,0.10) 45%,
      rgba(122,240,66,0.42) 50%,
      rgba(122,240,66,0.10) 55%,
      transparent 100%
    );
    transform:translateX(110%);
    animation:sweepRL 0.9s linear infinite;
    mix-blend-mode:screen;
    max-width:100%;
  }
  @keyframes sweepRL{
    from{ transform:translateX(110%); }
    to  { transform:translateX(-110%); }
  }

  .copy{
    position:relative;
    white-space:pre-wrap;
    word-break:break-word;
    overflow-wrap:anywhere;
    line-height: clamp(1.12, 0.9 + 0.4vw, 1.22);
  }

  .underline{
    position:absolute;
    left:0; right:0; bottom:-.12em;
    height:.12em;
    background:var(--fg);
    opacity:.85;
  }

  .dim { opacity: .68; }
  .dim2{ opacity: .52; }
  .bright{ opacity: 1; }
  .priority { opacity:1; letter-spacing: .02em; }
  .priority .copy { text-shadow: 0 0 12px rgba(122,240,66,.16); }

  .classified .copy{ opacity: .58; letter-spacing: .01em; }
  .classified .mask{
    position:absolute;
    left:0;
    right:0;
    top:0.15em;
    height:1.05em;
    background:rgba(0,0,0,0.65);
    border:1px solid rgba(122,240,66,0.18);
    pointer-events:none;
    mix-blend-mode:multiply;
    transform:translateX(-110%);
    animation: maskPass 0.85s ease-out 1;
  }
  @keyframes maskPass{
    from{ transform:translateX(-110%); opacity:0.0; }
    20%{ opacity:0.9; }
    to  { transform:translateX(110%); opacity:0.0; }
  }

  #bottom{
    border-top:1px solid var(--line2);
    padding: 10px 12px calc(10px + env(safe-area-inset-bottom));
    display:flex;
    justify-content:flex-end;
    align-items:center;
    min-height:56px;
    background: rgba(0,0,0,.10);
  }

  .await_box{
    display:none;
    padding:.32em .58em;
    border:1px solid rgba(122,240,66,.9);
    background:transparent;
    text-transform:uppercase;
    cursor:pointer;
    user-select:none;
    -webkit-tap-highlight-color: transparent;
    -webkit-touch-callout:none;
    touch-action: manipulation;
    border-radius: 8px;
  }
  .await_box.visible{ display:inline-block; }

  .alert_box{
    display:inline-block;
    padding:.20em .40em;
    border:1px solid rgba(122,240,66,.9);
    background:transparent;
    text-transform:uppercase;
    box-sizing:border-box;
    border-radius: 8px;
  }

  /* single consistent flash only */
  @keyframes blinkConsistent { 0%,48%{opacity:1;} 50%,100%{opacity:.16;} }
  .blink_consistent{ animation: blinkConsistent .75s steps(1,end) infinite; }

  .paused_blink{ animation: none !important; opacity: 1 !important; }

  .confirmed{
    animation:none !important;
    opacity:1 !important;
    cursor:default;
    border-color: rgba(122,240,66,.45);
    filter: saturate(0.9);
  }

  #flash,#pulse,#flicker{
    position:fixed;
    inset:0;
    pointer-events:none;
  }
  #flash{ background:#7af042; opacity:0; z-index:10000; }
  #pulse{ background:rgba(122,240,66,.10); opacity:0; z-index:9998; }
  #flicker{ background:rgba(122,240,66,.04); opacity:0; z-index:9999; mix-blend-mode:screen; }

  @keyframes hJitter {
    0%{transform:translateX(0)}
    20%{transform:translateX(-10px)}
    40%{transform:translateX(8px)}
    60%{transform:translateX(-6px)}
    80%{transform:translateX(4px)}
    100%{transform:translateX(0)}
  }
  .h_jitter { animation:hJitter 120ms linear 1; }

  .boot_dim #workspace{ opacity: 0.92; }
</style>
</head>

<body class="boot_dim">
  <div id="app">
    <div id="topbar">
      <div id="title">MU/TH/UR 6500 // USCSS MONTERO</div>
      <div id="statusrow">
        <div id="statusline">DIRECTIVE CHANNEL — ACT 2 DELIVERY</div>
        <div id="clock">--:--:--</div>
      </div>
    </div>

    <div id="workspace">
      <div id="wsHeader">
        <div id="wsTitle">DIRECTIVE</div>
        <div id="wsMeta">OPERATOR: LUCAS, MASON // ROUTE: INTERNAL</div>
      </div>

      <div id="linewrap" aria-live="polite">
        <div id="measure"></div>
      </div>

      <div id="bottom">
        <div id="await" class="await_box blink_consistent" role="button" tabindex="0" aria-label="Awaiting acknowledgement">
          AWAITING ACKNOWLEDGEMENT
        </div>
      </div>
    </div>
  </div>

  <div id="flash"></div>
  <div id="flicker"></div>
  <div id="pulse"></div>

<script>
  // Clock (Wilson-style topbar)
  const clockEl = document.getElementById("clock");
  function pad2(n){ return String(n).padStart(2,"0"); }
  function nowClock(){
    const d = new Date();
    return `${pad2(d.getHours())}:${pad2(d.getMinutes())}:${pad2(d.getSeconds())}`;
  }
  setInterval(()=> clockEl.textContent = nowClock(), 250);
  clockEl.textContent = nowClock();

  const linewrap  = document.getElementById("linewrap");
  const measure   = document.getElementById("measure");
  const awaitBox  = document.getElementById("await");
  const flash     = document.getElementById("flash");
  const pulse     = document.getElementById("pulse");
  const workspace = document.getElementById("workspace");

  const TYPE_SPEED = 36;

  const DEAD_AIR_AROUND_HEARTBEAT = 900;
  const DEAD_AIR_AFTER_LAST_LINE  = 950;

  let autoscroll = true;
  let awaitShownAt = 0;

const LINES = [
    { t: "TO: USCSS MONTERO - AGENT CODENAME LUCAS", underline:true,  cls:"bright" },
    { t: "FROM BIONATIONAL", underline:false,  cls:"bright" },
    { t: "ACT 2 PERSONAL AGENDA", underline:false,  cls:"bright" },
    { t: "YOU MUST LEARN MORE ABOUT THE XENOMORPHIC MATERIALS ONBOARD THE CRONUS", underline:false, cls:"bright" },
    { t: "ASK THE CREW, ACCESS THE SHIP'S LOGS", underline:false, cls:"bright" },
    { t: "DO ANYTHING ELSE YOU CAN TO LEARN MORE ABOUT THIS THREAT", underline:false, cls:"bright" },
    { t: "BUT BE CAREFUL NOT TO RAISE SUSPICIONS AMONG THE CREW", underline:false, cls:"bright" },
    { t: "DON'T EXPOSE YOURSELF AS AN ANDROID", underline:false, cls:"bright" },
  ];

  let acknowledged = false;
  let pauseBlinkTimer = null;

  function sleep(ms){ return new Promise(r => setTimeout(r, ms)); }

  function flashScreen(){
    flash.style.opacity = 0.85;
    setTimeout(() => flash.style.opacity = 0, 90);
  }

  function scrollIfNeeded(){
    if(!autoscroll) return;
    linewrap.scrollTop = linewrap.scrollHeight;
  }

  // subtle flicker
  let flickerRunning = true;
  (async function flickerLoop(){
    const flicker = document.getElementById("flicker");
    while(flickerRunning){
      await sleep(450 + Math.random() * 950);
      if(Math.random() < 0.6) continue;
      const pulses = 1 + Math.floor(Math.random() * 3);
      for(let i=0;i<pulses;i++){
        flicker.style.opacity = String(Math.random() * 0.22);
        await sleep(30 + Math.random() * 60);
        flicker.style.opacity = "0";
        await sleep(20 + Math.random() * 120);
      }
    }
  })();

  async function heartbeat(){
    pulse.style.opacity = 0.25;
    await sleep(90);
    pulse.style.opacity = 0;
    await sleep(140);
    pulse.style.opacity = 0.18;
    await sleep(70);
    pulse.style.opacity = 0;
    await sleep(650);
  }

  function triggerOneTimeJitter(){
    workspace.classList.remove("h_jitter");
    void workspace.offsetWidth;
    workspace.classList.add("h_jitter");
    setTimeout(() => workspace.classList.remove("h_jitter"), 180);
  }

  function makeLine({underline=false, cls=""} = {}){
    const line = document.createElement("div");
    line.className = `line ${cls}`.trim();

    const sweep = document.createElement("div");
    sweep.className = "sweep";
    line.appendChild(sweep);

    const copy = document.createElement("div");
    copy.className = "copy";
    line.appendChild(copy);

    if(underline){
      const u = document.createElement("div");
      u.className = "underline";
      copy.appendChild(u);
    }

    if(cls.includes("classified")){
      const m = document.createElement("div");
      m.className = "mask";
      line.appendChild(m);
    }

    measure.appendChild(line);
    scrollIfNeeded();

    let tn = document.createTextNode("");
    copy.insertBefore(tn, copy.firstChild);

    return { sweep, tn, copy };
  }

  async function typeLine(spec){
    const built = makeLine(spec);
    const text = spec.t;

    let targetNode = built.tn;

    if(spec.special === "remove"){
      built.copy.removeChild(built.tn);

      const box = document.createElement("span");
      box.className = "alert_box alert_flash";
      box.textContent = "";
      built.copy.insertBefore(box, built.copy.firstChild);

      targetNode = box;
    }

    for(let i=0; i<text.length; i++){
      if(targetNode.nodeType === 3){
        targetNode.nodeValue += text[i];
      } else {
        targetNode.textContent += text[i];
      }

      if(spec.special === "remove"){
        if(targetNode.textContent.endsWith("REMOVE MONTERO")) await sleep(520);
        if(targetNode.textContent.endsWith("FROM ")) await sleep(180);
      }

      scrollIfNeeded();
      await sleep(TYPE_SPEED);
    }

    built.sweep.remove();
  }

  function showAwaitBox(){
    awaitBox.classList.add("visible");
    autoscroll = false;
    awaitShownAt = performance.now();

    awaitBox.classList.remove("confirmed","paused_blink");
    awaitBox.classList.add("blink_consistent");
    awaitBox.textContent = "AWAITING ACKNOWLEDGEMENT";
  }

  function pauseBlinkBriefly(){
    if(!awaitBox.classList.contains("visible")) return;
    if(acknowledged) return;

    awaitBox.classList.add("paused_blink");
    clearTimeout(pauseBlinkTimer);
    pauseBlinkTimer = setTimeout(() => {
      if(acknowledged) return;
      awaitBox.classList.remove("paused_blink");
    }, 450);
  }

  async function maybeIntegrityDelay(){
    const dt = performance.now() - awaitShownAt;
    if(dt < 500) await sleep(300);
  }

  async function systemBreath(){
    await sleep(520 + Math.random() * 320);
    document.body.classList.remove("boot_dim");
  }

  async function deliver(){
    await systemBreath();
    flashScreen();

    for(const spec of LINES){
      if(spec.special === "remove"){
        await sleep(DEAD_AIR_AROUND_HEARTBEAT);
        triggerOneTimeJitter();
        await heartbeat();
        await sleep(DEAD_AIR_AROUND_HEARTBEAT);
      }
      await typeLine(spec);
    }

    await sleep(DEAD_AIR_AFTER_LAST_LINE);
    showAwaitBox();
  }

  function hardClose(){
    flickerRunning = false;
    document.body.innerHTML = "";
    try { window.close(); } catch {}
    try { location.replace("about:blank"); } catch { location.href="about:blank"; }
  }

  async function acknowledge(){
    if(acknowledged) return;
    acknowledged = true;

    clearTimeout(pauseBlinkTimer);
    await maybeIntegrityDelay();

    awaitBox.classList.remove("blink_consistent","paused_blink");
    awaitBox.classList.add("confirmed");
    awaitBox.textContent = "ACKNOWLEDGEMENT RECORDED";
    awaitBox.style.pointerEvents = "none";
    awaitBox.style.cursor = "default";
    awaitBox.setAttribute("aria-disabled", "true");

    flashScreen();

    await sleep(420);
    await typeLine({ t: "DIRECTIVE LOGGED.", underline:true, cls:"bright" });
    await typeLine({ t: "SESSION TERMINATION IN 10 SECONDS.", underline:true, cls:"bright" });

    setTimeout(hardClose, 10000);
  }

  function activate(e){
    if(activate._fired) return;
    activate._fired = true;
    setTimeout(()=>activate._fired = false, 350);
    acknowledge();
  }

  awaitBox.addEventListener("pointerenter", pauseBlinkBriefly);
  awaitBox.addEventListener("touchstart", pauseBlinkBriefly, { passive:true });

  awaitBox.addEventListener("pointerup", activate);
  awaitBox.addEventListener("click", activate);
  awaitBox.addEventListener("touchend", activate);

  awaitBox.addEventListener("keydown", (e) => {
    if(e.key === "Enter" || e.key === " ") acknowledge();
  });

  deliver();
</script>
</body>
</html>
